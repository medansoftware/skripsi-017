<style type="text/css">
/* kode CSS tetap sama */
.chatbox {
  position: fixed;
  z-index: 1040;
  bottom: 0;
  right: 30px;
  width: 300px;
  height: 400px;
  background-color: #fff;
  font-family: 'Lato', sans-serif;
  transition: all 600ms cubic-bezier(0.19, 1, 0.22, 1);
  display: flex;
  flex-direction: column;
}
.chatbox--tray { bottom: -350px; }
.chatbox--closed { bottom: -400px; }
.chatbox .form-control:focus { border-color: #1f2836; }
.chatbox__title, .chatbox__body { border-bottom: none; }
.chatbox__title {
  min-height: 50px;
  padding-right: 10px;
  background-color: #1f2836;
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
}
.chatbox__title h5 {
  height: 50px;
  margin: 0 0 0 15px;
  line-height: 50px;
  position: relative;
  padding-left: 20px;
  flex-grow: 1;
}
.chatbox__title h5 a {
  color: #fff;
  max-width: 195px;
  display: inline-block;
  text-decoration: none;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.chatbox__title h5:before {
  content: '';
  display: block;
  position: absolute;
  top: 50%;
  left: 0;
  width: 12px;
  height: 12px;
  background: #4CAF50;
  border-radius: 6px;
  transform: translateY(-50%);
}
.chatbox__title__tray,
.chatbox__title__close {
  width: 24px;
  height: 24px;
  outline: 0;
  border: none;
  background-color: transparent;
  opacity: 0.5;
  cursor: pointer;
  transition: opacity 200ms;
}
.chatbox__title__tray:hover,
.chatbox__title__close:hover { opacity: 1; }
.chatbox__title__tray span {
  width: 12px;
  height: 12px;
  display: inline-block;
  border-bottom: 2px solid #fff
}
.chatbox__title__close svg {
  vertical-align: middle;
  stroke-linecap: round;
  stroke-linejoin: round;
  stroke-width: 1.2px;
}
.chatbox__body, .chatbox__credentials {
  padding: 15px;
  border-top: 0;
  background-color: #f5f5f5;
  border-left: 1px solid #ddd;
  border-right: 1px solid #ddd;
  flex-grow: 1;
}
.chatbox__credentials { display: none; }
.chatbox__credentials .form-control { box-shadow: none; }
.chatbox__body { overflow-y: auto; }
.chatbox__body__message { position: relative; }
.chatbox__body__message p {
  padding: 15px;
  border-radius: 4px;
  font-size: 14px;
  background-color: #fff;
  box-shadow: 1px 1px rgba(100, 100, 100, 0.1);
}
.chatbox__body__message img {
  width: 40px;
  height: 40px;
  border-radius: 4px;
  border: 2px solid #fcfcfc;
  position: absolute;
  top: 15px;
}
.chatbox__body__message--left p { margin-left: 15px; padding-left: 30px; text-align: left; }
.chatbox__body__message--left img { left: -5px; }
.chatbox__body__message--right p { margin-right: 15px; padding-right: 30px; text-align: right; }
.chatbox__body__message--right img { right: -5px; }
.chatbox__message {
  padding: 15px;
  min-height: 50px;
  outline: 0;
  resize: none;
  border: none;
  font-size: 12px;
  border: 1px solid #ddd;
  border-bottom: none;
  background-color: #fefefe;
}
.chatbox--empty { height: 262px; }
.chatbox--empty.chatbox--tray { bottom: -212px; }
.chatbox--empty.chatbox--closed { bottom: -262px; }
.chatbox--empty .chatbox__body, .chatbox--empty .chatbox__message { display: none; }
.chatbox--empty .chatbox__credentials { display: block; }

/* tombol pertanyaan */
.random-questions {
  background: #eef2f7;
  border-top: 1px solid #ddd;
  padding: 6px;
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  justify-content: center;
}
.random-question {
  background: #fff;
  border: 1px solid #ccc;
  border-radius: 16px;
  font-size: 11px;
  padding: 4px 8px;
  cursor: pointer;
  transition: background 0.2s;
}
.random-question:hover {
  background: #1f2836;
  color: white;
}
</style>

<div class="chatbox chatbox--tray chatbox--empty">
  <div class="chatbox__title">
    <h5><a href="#">Layanan Obrolan</a></h5>
    <button class="chatbox__title__tray"><span></span></button>
    <button class="chatbox__title__close">
      <span>
        <svg viewBox="0 0 12 12" width="12px" height="12px">
          <line stroke="#FFFFFF" x1="11.75" y1="0.25" x2="0.25" y2="11.75"></line>
          <line stroke="#FFFFFF" x1="11.75" y1="11.75" x2="0.25" y2="0.25"></line>
        </svg>
      </span>
    </button>
  </div>

  <div class="chatbox__body">
    {% for message in chat.chat_messages %}
    {% if message.sender == 'guest' %}
    <div class="chatbox__body__message chatbox__body__message--right">
      <img src="/assets/adminLTE/v2/dist/img/user1-128x128.jpg" alt="Picture">
      <p>{{ message.text }}</p>
    </div>
    {% else %}
    <div class="chatbox__body__message chatbox__body__message--left">
      <img src="/assets/adminLTE/v2/dist/img/user2-160x160.jpg" alt="Picture">
      <p>{{ message.text|raw }}</p>
    </div>
    {% endif %}
    {% endfor %}
  </div>

  <form class="chatbox__credentials">
    <div class="form-group">
      <label>Nama Anda</label>
      <input type="text" name="name" id="chat_auth_name" class="form-control" required>
    </div>
    <div class="form-group">
      <label>NPM</label>
      <input type="text" name="whatsapp" id="chat_auth_whatsapp" class="form-control" required>
    </div>
    <button type="submit" class="btn btn-success btn-block">Buka Obrolan</button>
  </form>

  <textarea class="chatbox__message" placeholder="Ketik Pesan..."></textarea>

  <!-- tempat tombol pertanyaan -->
  <div class="random-questions"></div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const messageInput = document.querySelector(".chatbox__message");
  const randomContainer = document.querySelector(".random-questions");
  const questions = [
    "apa saja Prodi Program Studi Fakultas Ilmu komputer FIKOM",
    "apa sajaRuangan di FIKOM",
    "Laboratorium di FIKOM Lab di Fikom",
    "Kapan jadwal UTS dan UAS?",
    "Bagaimana prosedur Pendaftaran Mahasiswa Baru",
    "Cara Cek Nilai KHS atau Transkrip Nilai",
    "Apa saja kegiatan akademik FIKOM?",
    " syarat cara mengajukan cuti kuliah",
    "jika tidak bisa ikut ujian",
    "Lupa password SIAK, bagaimana cara reset?",
    "prosedur pendaftaran Beasiswa KIP Kuliah di UNIKA",
    "UKT Uang kuliah tahunan Fikom",
    "Di mana alamat kampus unika ?",
    "Perkuliahan semester baru di mulai?",
    "MENGAKSES E- JURNAL jurnal KAKIFIKOM",
    "mengecek melihat Cek Nilai KHS Transkrip Nilai.",
    " syarat mengambil skripsi ?",
    "Kapan PKL Dilaksanakan?",
    "bagaimana penilaian dari evaluasi perkuliahan?",
    "apa kurikulum yang di berlakukan di FIKOM?",
    "bagaimana jika nilai Mata kuliah saya belum keluar?",
    "apakah ada Unit Kegiatan Kemahasiswaan di UNIKA ? UKM",
    "apa saja kegiatan akademik FIKOM?",
    "cara membuat mengajukan SURAT PERMOHONAN AKTIF KULIAH ?",
    "cara mengajukan ujian susulan",
    "cara mengajukan ujian pembersihan",
    "Syarat mahasiswa untuk mengikuti uas ?",
    "Event atau perlombaan di FIKOM?",
    "program Kampus Merdeka?",
    "Dekan FIKOM Fakultas Ilmu Komputer Sekarang?",
    "Ketua Prodi K.Prodi Teknik Informatika TI saat ini ?",
    "dosen di TI dosen Teknik informatika",
    "dosen perempuan TI di Fikom?",
    "dosen dengan gelar dokter di FIKOM?",
    "apa itu semester antara ?",
    "kapan dilakukan semester antara?",
    "apa mata kuliah di Prodi Teknik Informatika semester 1 ?",
    "apa mata kuliah sistem informasi atau SI semester 1 satu ?",
    "apa mata kuliah pilihan 1 satu Sistem informasi ?",
    "ruang belajar teori mengajar atau ruang kuliah yang tersedia ?",
    "siapa saja dosen di SI sistem informasi",
    "siapa saja dosen di Sains Data Data science",
    "siapa Ketua Prodi K.Prodi Sistem Informasi SI Saat ini?",
    "siapa Ketua Prodi K.Prodi Sains Data , Data Science saat ini ?",
    "siapa kepala Lab Laboratorium komputer saat ini",
    "apa syarat Mahasiswa mengikuti perkuliahan",
    "cara Membayar UKT uang kuliah",
    "apa saja jenis surat permohonan ?",
    "apa email fikom",
    "Akreditas TI Teknik Informatika ?",
    "akreditas SI Sistem Informasi ?",
    "Apa Mata kuliah Mk Teknik informatika TI Semester 1 satu ganjil Hari senin?",
    "Siapa Sekretaris Sek Sistem informasi SI",
    "Berapa jumlah Dosen yang ada di Fikom Fakultas ilmu komputer ?",
    "Berapa jumlah dosen Laki laki di Fikom Fakultas ilmu komputer?",
  ];

  function tampilkanPertanyaan() {
    randomContainer.innerHTML = "";
    const acak = [...questions].sort(() => 0.5 - Math.random()).slice(0, 3); // hanya 3 pertanyaan
    acak.forEach(q => {
      const btn = document.createElement("button");
      btn.type = "button";
      btn.className = "random-question";
      btn.textContent = q;
      btn.addEventListener("click", () => {
        messageInput.value = q;
        randomContainer.style.display = "none";
      });
      randomContainer.appendChild(btn);
    });
    randomContainer.style.display = "flex";
  }

  tampilkanPertanyaan();

  // Setelah pesan dikirim (Enter), tampilkan tombol lagi
  messageInput.addEventListener("keydown", function (e) {
    if (e.key === "Enter" && !e.shiftKey) {
      setTimeout(() => tampilkanPertanyaan(), 1000);
    }
  });
});
</script>
